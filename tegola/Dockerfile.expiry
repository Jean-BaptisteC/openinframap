# Container with the Tegola tileserver binary and the expire.py script,
# which is used to invalidate tiles based on expiry files generated by Imposm.
FROM ghcr.io/openinframap/tileserver

RUN apk update && \
    apk add python3 py3-pip && \
    rm -Rf /var/cache/apk/*

RUN pip3 install inotify==0.2.10 click==8.1.3

WORKDIR /app
COPY expire.py .

ENTRYPOINT ["/usr/bin/python3", "/app/expire.py", "/imposm-expiry"]